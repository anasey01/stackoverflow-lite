{"version":3,"sources":["../../auth/Authentication.js"],"names":["Authentication","connection","conn","table","fullname","gender","username","password","email","callback","selectUserByUsername","err","result","console","log","length","createUser","insertUser","userData","storedHashedPassword","correctPassword","bcrypt","compareSync"],"mappings":";;;;;;;;;;AAAA;;;;;;;;IAEMA,c;AACJ,0BAAYC,UAAZ,EAAwB;AAAA;;AACtB,SAAKC,IAAL,GAAYD,UAAZ;AACA,SAAKE,KAAL,GAAa,OAAb;AACD;;;;iCAEYC,Q,EAAUC,M,EAAQC,Q,EAAUC,Q,EAAUC,K,EAAOC,Q,EAAU;AAAA;;AAClE,WAAKP,IAAL,CAAUQ,oBAAV,CAA+BJ,QAA/B,EAAyC,UAACK,GAAD,EAAMC,MAAN,EAAiB;AACxDC,gBAAQC,GAAR,CAAY,gCAAZ,EAA8CF,MAA9C;AACA,YAAID,GAAJ,EAAS;AACPF,mBAASE,GAAT;AACD,SAFD,MAEO,IAAIC,OAAOG,MAAP,GAAgB,CAAhB,IAAqBH,OAAOG,MAAP,KAAkB,CAA3C,EAA8C;AACnD,gBAAKC,UAAL,CAAgBZ,QAAhB,EAA0BC,MAA1B,EAAkCC,QAAlC,EAA4CC,QAA5C,EAAsDC,KAAtD,EAA6DC,QAA7D;AACD,SAFM,MAEA;AACLA,mBAAS,UAAT;AACD;AACF,OATD;AAUD;;;+BAEUL,Q,EAAUC,M,EAAQC,Q,EAAUC,Q,EAAUC,K,EAAOC,Q,EAAU;AAChE,WAAKP,IAAL,CAAUe,UAAV,CAAqBb,QAArB,EAA+BC,MAA/B,EAAuCC,QAAvC,EAAiDC,QAAjD,EAA2DC,KAA3D,EAAkE,UAACG,GAAD,EAAMC,MAAN,EAAiB;AACjF,YAAID,GAAJ,EAAS;AACPF,mBAAS,iCAAT;AACD;AACDA,8BAAoBL,QAApB;AACD,OALD;AAMD;;;0BAEKE,Q,EAAUC,Q,EAAUE,Q,EAAU;AAClC,WAAKP,IAAL,CAAUQ,oBAAV,CAA+BJ,QAA/B,EAAyC,UAACK,GAAD,EAAMC,MAAN,EAAiB;AACxD,YAAIA,OAAOG,MAAP,GAAgB,CAApB,EAAuB;AACrBN,mBAAS,gCAAT;AACD,SAFD,MAEO;AACL,cAAMS,WAAWN,MAAjB;AACA,cAAMO,uBAAuBD,SAAS,CAAT,EAAYX,QAAzC;AACA,cAAMa,kBAAkBC,iBAAOC,WAAP,CAAmBf,QAAnB,EAA6BY,oBAA7B,CAAxB;AACA,cAAI,QAAOP,MAAP,yCAAOA,MAAP,OAAkB,QAAlB,IAA8B,CAACQ,eAAnC,EAAoD;AAClDX,qBAAS,gCAAT;AACD,WAFD,MAEO;AACLA,qBAASG,MAAT;AACD;AACF;AACF,OAbD;AAcD;;;;;;kBAEYZ,c","file":"Authentication.js","sourcesContent":["import bcrypt from 'bcrypt';\n\nclass Authentication {\n  constructor(connection) {\n    this.conn = connection;\n    this.table = 'users';\n  }\n\n  registerUser(fullname, gender, username, password, email, callback) {\n    this.conn.selectUserByUsername(username, (err, result) => {\n      console.log('The result from register user ', result);\n      if (err) {\n        callback(err);\n      } else if (result.length < 1 && result.length !== 1) {\n        this.createUser(fullname, gender, username, password, email, callback);\n      } else {\n        callback('existing');\n      }\n    });\n  }\n\n  createUser(fullname, gender, username, password, email, callback) {\n    this.conn.insertUser(fullname, gender, username, password, email, (err, result) => {\n      if (err) {\n        callback('There was an error adding user!');\n      }\n      callback(`Welcome ${fullname}`);\n    });\n  }\n\n  login(username, password, callback) {\n    this.conn.selectUserByUsername(username, (err, result) => {\n      if (result.length < 1) {\n        callback('username or password incorrect');\n      } else {\n        const userData = result;\n        const storedHashedPassword = userData[0].password;\n        const correctPassword = bcrypt.compareSync(password, storedHashedPassword);\n        if (typeof result !== 'object' || !correctPassword) {\n          callback('Username or Password incorrect');\n        } else {\n          callback(result);\n        }\n      }\n    });\n  }\n}\nexport default Authentication;\n"]}