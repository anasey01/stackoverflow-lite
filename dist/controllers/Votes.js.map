{"version":3,"sources":["../../controllers/Votes.js"],"names":["db","DatabaseManager","questionManager","QuestionManager","Votes","req","res","params","questionId","answerId","userId","user","createVotes","err","result","votes","totalVotes","length","totalUpvote","totalDownvote","questionid","answerid","status","json","success","messgae","forEach","item","upvotes","downvotes","messgage"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;AAEA,IAAMA,KAAK,IAAIC,yBAAJ,EAAX;AACA,IAAMC,kBAAkB,IAAIC,yBAAJ,CAAoBH,EAApB,CAAxB;;IAEMI,K;;;;;;;2BACUC,G,EAAKC,G,EAAK;AAAA,wBACWD,IAAIE,MADf;AAAA,UACdC,UADc,eACdA,UADc;AAAA,UACFC,QADE,eACFA,QADE;AAAA,UAEdC,MAFc,GAEHL,IAAIM,IAFD,CAEdD,MAFc;;AAGtBR,sBAAgBU,WAAhB,CAA4BJ,UAA5B,EAAwCC,QAAxC,EAAkDC,MAAlD,EAA0D,SAA1D,EAAqE,WAArE,EAAkF,UAACG,GAAD,EAAMC,MAAN,EAAiB;AACjG,YAAIC,QAAQ;AACVC,sBAAYF,OAAOG,MADT;AAEVC,uBAAa,CAFH;AAGVC,yBAAe,CAHL;AAIVX,sBAAYM,OAAO,CAAP,EAAUM,UAJZ;AAKVX,oBAAUK,OAAO,CAAP,EAAUO;AALV,SAAZ;AAOA,YAAIR,GAAJ,EAAS;AACPP,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,KADU;AAEnBC,qBAAS;AAFU,WAArB;AAID,SALD,MAKO;AACLX,iBAAOY,OAAP,CAAe,UAACC,IAAD,EAAU;AACvBZ,kBAAMG,WAAN,IAAqBS,KAAKC,OAA1B;AACAb,kBAAMI,aAAN,IAAuBQ,KAAKE,SAA5B;AACD,WAHD;AAIAvB,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,IADU;AAEnBM,sBAAU,iBAFS;AAGnBf;AAHmB,WAArB;AAKD;AACF,OAxBD;AAyBD;;;6BAEeV,G,EAAKC,G,EAAK;AAAA,yBACSD,IAAIE,MADb;AAAA,UAChBC,UADgB,gBAChBA,UADgB;AAAA,UACJC,QADI,gBACJA,QADI;AAAA,UAEhBC,MAFgB,GAELL,IAAIM,IAFC,CAEhBD,MAFgB;;AAGxBR,sBAAgBU,WAAhB,CAA4BJ,UAA5B,EAAwCC,QAAxC,EAAkDC,MAAlD,EAA0D,WAA1D,EAAuE,SAAvE,EAAkF,UAACG,GAAD,EAAMC,MAAN,EAAiB;AACjG,YAAIC,QAAQ;AACVC,sBAAYF,OAAOG,MADT;AAEVC,uBAAa,CAFH;AAGVC,yBAAe,CAHL;AAIVX,sBAAYM,OAAO,CAAP,EAAUM,UAJZ;AAKVX,oBAAUK,OAAO,CAAP,EAAUO;AALV,SAAZ;AAOA,YAAIR,GAAJ,EAAS;AACPP,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,KADU;AAEnBC,qBAAS;AAFU,WAArB;AAID,SALD,MAKO;AACLX,iBAAOY,OAAP,CAAe,UAACC,IAAD,EAAU;AACvBZ,kBAAMG,WAAN,IAAqBS,KAAKC,OAA1B;AACAb,kBAAMI,aAAN,IAAuBQ,KAAKE,SAA5B;AACD,WAHD;AAIAvB,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,IADU;AAEnBM,sBAAU,iBAFS;AAGnBf;AAHmB,WAArB;AAKD;AACF,OAxBD;AAyBD;;;;;;kBAEYX,K","file":"Votes.js","sourcesContent":["import DatabaseManager from '../net/DatabaseManager';\nimport QuestionManager from './QuestionManager';\n\nconst db = new DatabaseManager();\nconst questionManager = new QuestionManager(db);\n\nclass Votes {\n  static upvote(req, res) {\n    const { questionId, answerId } = req.params;\n    const { userId } = req.user;\n    questionManager.createVotes(questionId, answerId, userId, 'upvotes', 'downvotes', (err, result) => {\n      let votes = {\n        totalVotes: result.length,\n        totalUpvote: 0,\n        totalDownvote: 0,\n        questionId: result[0].questionid,\n        answerId: result[0].answerid,\n      }\n      if (err) {\n        res.status(401).json({\n          success: false,\n          messgae: 'unable to vote',\n        });\n      } else {\n        result.forEach((item) => {\n          votes.totalUpvote += item.upvotes;\n          votes.totalDownvote += item.downvotes;\n        });\n        res.status(200).json({\n          success: true,\n          messgage: 'stats for votes',\n          votes,\n        });\n      }\n    });\n  }\n\n  static downvote(req, res) {\n    const { questionId, answerId } = req.params;\n    const { userId } = req.user;\n    questionManager.createVotes(questionId, answerId, userId, 'downvotes', 'upvotes', (err, result) => {\n      let votes = {\n        totalVotes: result.length,\n        totalUpvote: 0,\n        totalDownvote: 0,\n        questionId: result[0].questionid,\n        answerId: result[0].answerid,\n      }\n      if (err) {\n        res.status(401).json({\n          success: false,\n          messgae: 'unable to vote',\n        });\n      } else {\n        result.forEach((item) => {\n          votes.totalUpvote += item.upvotes;\n          votes.totalDownvote += item.downvotes;\n        });\n        res.status(200).json({\n          success: true,\n          messgage: 'stats for votes',\n          votes,\n        });\n      }\n    });\n  }\n}\nexport default Votes;\n"]}