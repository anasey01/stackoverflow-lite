{"version":3,"sources":["../../controllers/Votes.js"],"names":["db","DatabaseManager","questionManager","QuestionManager","Votes","req","res","params","questionId","answerId","userId","user","createVotes","err","result","votes","totalVotes","length","totalUpvote","totalDownvote","questionid","answerid","status","json","success","messgae","forEach","item","upvotes","downvotes","messgage"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;AAEA,IAAMA,KAAK,IAAIC,yBAAJ,EAAX;AACA,IAAMC,kBAAkB,IAAIC,yBAAJ,CAAoBH,EAApB,CAAxB;;IAEMI,K;;;;;;;2BACUC,G,EAAKC,G,EAAK;AAAA,wBACWD,IAAIE,MADf;AAAA,UACdC,UADc,eACdA,UADc;AAAA,UACFC,QADE,eACFA,QADE;AAAA,UAEdC,MAFc,GAEHL,IAAIM,IAFD,CAEdD,MAFc;;AAGtBR,sBAAgBU,WAAhB,CAA4BJ,UAA5B,EAAwCC,QAAxC,EAAkDC,MAAlD,EAA0D,SAA1D,EAAqE,WAArE,EAAkF,UAACG,GAAD,EAAMC,MAAN,EAAiB;AACjG,YAAIC,QAAQ;AACVC,sBAAYF,OAAOG,MADT;AAEVC,uBAAa,CAFH;AAGVC,yBAAe,CAHL;AAIVX,sBAAYM,OAAO,CAAP,EAAUM,UAJZ;AAKVX,oBAAUK,OAAO,CAAP,EAAUO;AALV,SAAZ;AAOA,YAAIR,GAAJ,EAAS;AACPP,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,KADU;AAEnBC,qBAAS;AAFU,WAArB;AAID,SALD,MAKO;AACLX,iBAAOY,OAAP,CAAe,UAACC,IAAD,EAAU;AACvBZ,kBAAMG,WAAN,IAAqBS,KAAKC,OAA1B;AACAb,kBAAMI,aAAN,IAAuBQ,KAAKE,SAA5B;AACD,WAHD;AAIAvB,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,IADU;AAEnBM,sBAAU,iBAFS;AAGnBf;AAHmB,WAArB;AAKD;AACF,OAxBD;AAyBD;;;6BAEeV,G,EAAKC,G,EAAK;AAAA,yBACSD,IAAIE,MADb;AAAA,UAChBC,UADgB,gBAChBA,UADgB;AAAA,UACJC,QADI,gBACJA,QADI;AAAA,UAEhBC,MAFgB,GAELL,IAAIM,IAFC,CAEhBD,MAFgB;;AAGxBR,sBAAgBU,WAAhB,CAA4BJ,UAA5B,EAAwCC,QAAxC,EAAkDC,MAAlD,EAA0D,WAA1D,EAAuE,SAAvE,EAAkF,UAACG,GAAD,EAAMC,MAAN,EAAiB;AACjG,YAAIC,QAAQ;AACVC,sBAAYF,OAAOG,MADT;AAEVC,uBAAa,CAFH;AAGVC,yBAAe,CAHL;AAIVX,sBAAYM,OAAO,CAAP,EAAUM,UAJZ;AAKVX,oBAAUK,OAAO,CAAP,EAAUO;AALV,SAAZ;AAOA,YAAIR,GAAJ,EAAS;AACPP,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,KADU;AAEnBC,qBAAS;AAFU,WAArB;AAID,SALD,MAKO;AACLX,iBAAOY,OAAP,CAAe,UAACC,IAAD,EAAU;AACvBZ,kBAAMG,WAAN,IAAqBS,KAAKC,OAA1B;AACAb,kBAAMI,aAAN,IAAuBQ,KAAKE,SAA5B;AACD,WAHD;AAIAvB,cAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,qBAAS,IADU;AAEnBM,sBAAU,iBAFS;AAGnBf;AAHmB,WAArB;AAKD;AACF,OAxBD;AAyBD;;;;;;kBAEYX,K","file":"Votes.js","sourcesContent":["import DatabaseManager from '../net/DatabaseManager';\r\nimport QuestionManager from './QuestionManager';\r\n\r\nconst db = new DatabaseManager();\r\nconst questionManager = new QuestionManager(db);\r\n\r\nclass Votes {\r\n  static upvote(req, res) {\r\n    const { questionId, answerId } = req.params;\r\n    const { userId } = req.user;\r\n    questionManager.createVotes(questionId, answerId, userId, 'upvotes', 'downvotes', (err, result) => {\r\n      let votes = {\r\n        totalVotes: result.length,\r\n        totalUpvote: 0,\r\n        totalDownvote: 0,\r\n        questionId: result[0].questionid,\r\n        answerId: result[0].answerid,\r\n      }\r\n      if (err) {\r\n        res.status(401).json({\r\n          success: false,\r\n          messgae: 'unable to vote',\r\n        });\r\n      } else {\r\n        result.forEach((item) => {\r\n          votes.totalUpvote += item.upvotes;\r\n          votes.totalDownvote += item.downvotes;\r\n        });\r\n        res.status(200).json({\r\n          success: true,\r\n          messgage: 'stats for votes',\r\n          votes,\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  static downvote(req, res) {\r\n    const { questionId, answerId } = req.params;\r\n    const { userId } = req.user;\r\n    questionManager.createVotes(questionId, answerId, userId, 'downvotes', 'upvotes', (err, result) => {\r\n      let votes = {\r\n        totalVotes: result.length,\r\n        totalUpvote: 0,\r\n        totalDownvote: 0,\r\n        questionId: result[0].questionid,\r\n        answerId: result[0].answerid,\r\n      }\r\n      if (err) {\r\n        res.status(401).json({\r\n          success: false,\r\n          messgae: 'unable to vote',\r\n        });\r\n      } else {\r\n        result.forEach((item) => {\r\n          votes.totalUpvote += item.upvotes;\r\n          votes.totalDownvote += item.downvotes;\r\n        });\r\n        res.status(200).json({\r\n          success: true,\r\n          messgage: 'stats for votes',\r\n          votes,\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\nexport default Votes;\r\n"]}