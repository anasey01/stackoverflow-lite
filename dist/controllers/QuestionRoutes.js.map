{"version":3,"sources":["../../controllers/QuestionRoutes.js"],"names":["db","DatabaseManager","questionManager","QuestionManager","QuestionRoute","req","res","getAllQuestion","data","err","status","json","success","message","questions","questionId","params","id","getQuestion","error","result","question","body","questionTitle","questionContent","user","userId","username","createQuestion","userid","questionid","questiontitle","questioncontent","createdAt","createdat","Number","answer","getQuestionAndAnswer","answerNumber","length","createAnswer","answerInfo","rows","userComment","getUserQuestions","userQuestions","deleteOne","isDeleted","rowCount","updateAnswer","answerUpdate","orderedByMostAnswers","mostAnswers","queryParameter","query","q","searchQuestion","match"],"mappings":"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","file":"QuestionRoutes.js","sourcesContent":["import DatabaseManager from '../net/DatabaseManager';\r\nimport QuestionManager from './QuestionManager';\r\n\r\nconst db = new DatabaseManager();\r\nconst questionManager = new QuestionManager(db);\r\n\r\nclass QuestionRoute {\r\n  static allQuestion(req, res) {\r\n    questionManager.getAllQuestion((data, err) => {\r\n      if (err) {\r\n        return res.status(500).json({\r\n          success: false,\r\n          message: 'No question found',\r\n        });\r\n      }\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'All Questions Retrieved',\r\n        questions: data,\r\n      });\r\n    });\r\n  }\r\n\r\n  static specificQuestion(req, res) {\r\n    const questionId = req.params.id;\r\n    questionManager.getQuestion(questionId, (error, result) => {\r\n      const question = result;\r\n      if (error) {\r\n        return res.status(500).json({\r\n          success: false,\r\n          message: 'Failed to fetch question',\r\n        });\r\n      }\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'successfully fetched question',\r\n        question,\r\n      });\r\n    });\r\n  }\r\n\r\n  static postQuestion(req, res) {\r\n    const { questionTitle, questionContent } = req.body;\r\n    const { userId, username } = req.user;\r\n    questionManager.createQuestion(userId, questionTitle, questionContent, username, (err, result) => {\r\n      if (err) {\r\n        return res.status(400).json({\r\n          success: false,\r\n          message: 'unable to create question',\r\n        });\r\n      }\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'question successfully created',\r\n        username: result[0].username,\r\n        userId: result[0].userid,\r\n        questionId: result[0].questionid,\r\n        questionTitle: result[0].questiontitle,\r\n        questionContent: result[0].questioncontent,\r\n        createdAt: result[0].createdat,\r\n      });\r\n    });\r\n  }\r\n\r\n  static addAnswer(req, res) {\r\n    const questionId = Number(req.params.id);\r\n    const { userId, username } = req.user;\r\n    const { answer } = req.body;\r\n    questionManager.getQuestionAndAnswer(questionId, (err, result) => {\r\n      if (err) {\r\n        return res.status(500).json({\r\n          success: false,\r\n          message: 'unable to retrieve answers',\r\n        });\r\n      }\r\n      const answerNumber = result.length + 1;\r\n      questionManager.createAnswer(userId, questionId, answer, answerNumber, username, (error, data) => {\r\n        if (error) {\r\n          return res.status(500).json({\r\n            success: false,\r\n            message: 'Unable to add answer',\r\n          });\r\n        }\r\n        const answerInfo = data.rows[0];\r\n        return res.status(200).json({\r\n          success: true,\r\n          message: 'Your answer has been successfully added',\r\n          answerInfo,\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  static getAnswer(req, res) {\r\n    const questionId = Number(req.params.id);\r\n    const { userComment } = req;\r\n    questionManager.getQuestionAndAnswer(questionId, (err, result) => {\r\n      const data = {\r\n        answer: {\r\n          result, userComment,\r\n        },\r\n      };\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'Successfully retrieved all answers',\r\n        data,\r\n      });\r\n    });\r\n  }\r\n\r\n  static getAllQuestionsByUser(req, res) {\r\n    const { username } = req.user;\r\n    questionManager.getUserQuestions(username, (error, result) => {\r\n      const userQuestions = result;\r\n      if (error) {\r\n        return res.status(500).json({\r\n          success: false,\r\n          message: 'unable to retrieve questions',\r\n        });\r\n      }\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'All Questions by User',\r\n        userQuestions,\r\n      });\r\n    });\r\n  }\r\n\r\n  static deleteQuestion(req, res) {\r\n    const { id } = req.params;\r\n    questionManager.deleteOne(id, (result, err) => {\r\n      let isDeleted = '';\r\n      if (result.rowCount === 1) {\r\n        isDeleted = 'deleted';\r\n      }\r\n      if (isDeleted === 'deleted') {\r\n        return res.status(200).json({\r\n          success: true,\r\n          message: 'Question deleted!',\r\n        });\r\n      }\r\n      if (isDeleted === '') {\r\n        return res.status(401).json({\r\n          success: false,\r\n          message: 'Unable to delete question',\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  static updateAnswer(req, res) {\r\n    const { questionId, answerNumber } = req.params;\r\n    const { answer } = req.body;\r\n    questionManager.updateAnswer(answerNumber, answer, questionId, (error, answerUpdate) => {\r\n      if (error) {\r\n        return res.status(500).json({\r\n          success: false,\r\n          message: 'Unable to update Answer',\r\n        });\r\n      }\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'Your answer has been updated',\r\n        answer: answerUpdate[0],\r\n      });\r\n    });\r\n  }\r\n\r\n  static mostAnswers(req, res) {\r\n    const { username } = req.user;\r\n    questionManager.orderedByMostAnswers(username, (error, mostAnswers) => {\r\n      if (error) {\r\n        return res.status(500).json({\r\n          success: false,\r\n          message: 'unable to get most answered question',\r\n        });\r\n      }\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'Questions by user with the most answers',\r\n        mostAnswers,\r\n      });\r\n    });\r\n  }\r\n\r\n  static searchQuestion(req, res) {\r\n    const queryParameter = req.query.q;\r\n    questionManager.searchQuestion(queryParameter, (error, match) => {\r\n      if (error) {\r\n        return res.status(500).json({\r\n          success: false,\r\n          message: 'An error occurred while searching for question',\r\n        });\r\n      }\r\n      return res.status(200).json({\r\n        success: true,\r\n        message: 'Search result successful',\r\n        match,\r\n      });\r\n    });\r\n  }\r\n\r\n  static notFound(req, res) {\r\n    return res.status(404).json({\r\n      status: false,\r\n      message: 'Not Found!',\r\n    });\r\n  }\r\n}\r\n\r\nexport default QuestionRoute;\r\n"]}